# User Authentication

In order to start getting data from the database, you will need an Authentication Token to get access. Follow the next steps to
get your access token and start making http requests.

## Login

In order to get the Access Token, send a http request with the following configuration.

Method: GET
URL: http://localhost:3000/api/login

Headers
```json
"Content-Type": "application/json"
```

Body
```json
{
  "user": {
    "email": "jorge.ortiz@icalialabs.com",
    "displayName": "Jorge Ortiz",
    "uid": "someGoogleUid123"
  }
}
```

Response
```json
{
  "auth_token": "eyJhbGciOiJub25lIn0.eyJpZCI6MSwiZW1haWwiOiJqb3JnZS5vcnRpekBpY2FsaWFsYWJzLmNvbSIsInRva2VuIjoiWkpWV29YY2JvWkdVWFB3WDZkTFpMc29aWlE1Z0VFd1Z4VGtoMkxjaVlqZHNnTFUzTGEifQ."
}
```

If you visit https://jwt.io and paste the token generated, you will see some information about the user:

```json
{
  "id": 1,
  "email": "jorge.ortiz@icalialabs.com",
  "token": "ZJVWoXcboZGUXPwX6dLZLsoZZQ5gEEwVxTkh2LciYjdsgLU3La"
}
```

## Validate JWT.

You can test your JWT token generated by making a HTTP request to the following URL:

Method: GET
URL: http://localhost:3000/api/hello

Headers
```json
"Authorization": "eyJhbGciOiJub25lIn0.eyJpZCI6MSwiZW1haWwiOiJqb3JnZS5vcnRpekBpY2FsaWFsYWJzLmNvbSIsInRva2VuIjoiWkpWV29YY2JvWkdVWFB3WDZkTFpMc29aWlE1Z0VFd1Z4VGtoMkxjaVlqZHNnTFUzTGEifQ."
```

Response
```json
{ "response": "Hello World" }
```

## LogOut

The Logout method will delete the authentication token that belongs to the user.

Method: GET
URL: http://localhost:3000/api/logout

Headers
```json
"Authorization": "eyJhbGciOiJub25lIn0.eyJpZCI6MSwiZW1haWwiOiJqb3JnZS5vcnRpekBpY2FsaWFsYWJzLmNvbSIsInRva2VuIjoiWkpWV29YY2JvWkdVWFB3WDZkTFpMc29aWlE1Z0VFd1Z4VGtoMkxjaVlqZHNnTFUzTGEifQ."
```

Response
```json
{ "response": "Authentication Token was deleted" }
```

## Notes.

Each time you click on the Login Button, a NEW TOKEN WILL BE GENERATED and the PREVIOUS TOKEN WILL BE DELETED from the database, no matter if
you didn't logout by clicking on the Logout button from the Frontend.

## Errors.

The base controller is ApiController. Depending on the case, an error will be sent to the client.

- *Auth Token was not provided*.

  This error shows the user that the auth token has not been added to the Headers under the name of **"Authorization"**

- *Authentication Token has expired*.

  This error occurs when the user is using and old token. If the user logs in twice with the same email and it uses the first token, that token will not be valid because it was deleted from the DB when he logged in again.

- *Authentication Token Invalid*.

  This error occurs when the JWT token has an invalid format.


That's it. \
Save your JWT token and use it to start making HTTP requests to the Backend.
